# API SecuGen Fingerprint ScannerEste proyecto proporciona una API REST para interactuar con lectores de huellas dactilares SecuGen, utilizando Docker para facilitar su despliegue.## Requisitos previos- Docker y Docker Compose- Lector de huellas SecuGen conectado por USB- Permisos sudo/root para configurar el dispositivo USB## Estructura del proyecto
   ```bash├── Dockerfile # Configuración para construir la imagen├── docker-compose.yml # Configuración de los servicios (API + MySQL)├── index.js # Punto de entrada de la aplicación Node.js├── match_template.c # Código C para comparar huellas├── set_led.c # Código C para controlar el LED y capturar huellas├── secugen/ # Bibliotecas y archivos del SDK SecuGen│ ├── lib/ # Bibliotecas compartidas (.so)│ └── include/ # Archivos de cabecera (.h)└── .env # Variables de entorno## Configuración inicial1. **Preparar las bibliotecas SecuGen** Copia las bibliotecas necesarias del SDK de SecuGen:
   ```bashmkdir -p secugen/lib secugen/include# Copiar la biblioteca principal y dependenciascp /ruta/al/sdk/lib/libsgfplib.so secugen/lib/cp /ruta/al/sdk/lib/libsgimage.so* secugen/lib/cp /ruta/al/sdk/lib/libsgfpamx.so* secugen/lib/cp /ruta/al/sdk/lib/libsgnfiq.so* secugen/lib/cp /ruta/al/sdk/lib/libAKXUS.so* secugen/lib/cp /ruta/al/sdk/lib/libuvc.so* secugen/lib/# Copiar archivos de cabeceracp /ruta/al/sdk/include/sgfplib.h secugen/include/2. **Configurar reglas de acceso USB** Crea reglas udev para permitir acceso al lector:
   ```bashsudo bash -c 'cat > /etc/udev/rules.d/99-secugen.rules << EOFSUBSYSTEM=="usb", ATTRS{idVendor}=="1162", ATTRS{idProduct}=="2201", MODE="0666"EOF'sudo udevadm control --reload-rulessudo udevadm trigger3. **Configurar variables de entorno** Crea o modifica el archivo .env con tus configuraciones:
   ```bashDB_HOST=192.168.100.2DB_PORT=3306DB_USER=rootDB_PASS=123456DB_NAME=secugen## Compilación y ejecución1. **Construir y levantar los contenedores**
   ```bash# Asegúrate de que puedes ver el dispositivo USBlsusb | grep SecuGen# Construye los contenedoresdocker-compose build# Levanta los servicios en segundo planodocker-compose up -d2. **Verificar el estado de los contenedores**
   ```bashdocker-compose ps## Pruebas1. **Probar el lector directamente**
   ```bash# Ejecutar el programa de prueba del LED dentro del contenedordocker exec -it secugen_api ./set_led2. **Probar la API REST**
   ```bash# Registrar una nueva huellacurl -X POST http://localhost:3000/fingerprint/save \ -H "Content-Type: application/json" \ -d '{"userId":1, "fingername":"test_finger"}'# Verificar una huellacurl -X POST http://localhost:3000/fingerprint/verify \ -H "Content-Type: application/json" \ -d '{"userId":1}'## Solución de problemas### Error de acceso al dispositivo USBSi recibes errores al abrir el dispositivo USB:
   ```bash# Verifica los permisos del dispositivols -la /dev/bus/usb/002/002 # Ajusta la ruta según tu dispositivo# Asegúrate de que el usuario tenga accesosudo chmod 666 /dev/bus/usb/002/002# Reinicia el dispositivo USBsudo sh -c 'echo 0 > /sys/bus/usb/devices/2-1/authorized'sleep 3sudo sh -c 'echo 1 > /sys/bus/usb/devices/2-1/authorized'### Error al compilar módulos nativos Node.jsSi hay errores al construir la imagen relacionados con módulos nativos:
   ```bash# Modifica el Dockerfile para usar Node.js 16 en lugar de versiones más recientes# En el Dockerfile:RUN curl -fsSL https://deb.nodesource.com/setup_16.x | bash - \ && apt-get install -y nodejs### Timeout en la captura de huellasSi el lector muestra errores de timeout durante la captura:
   ```bash# Prueba diferentes configuraciones de dispositivo en set_led.c// Probar SG_DEV_AUTO, SG_DEV_FDU08, o el modelo específico de tu lectorret = SGFPM_Init(sgfplib, SG_DEV_AUTO);// Aumentar el timeout si es necesarioDWORD timeout = 10000; // 10 segundosSGFPM_SetAutoOnIRLedTouchOn(sgfplib, timeout, 1);## Configuración adicional### Red de Docker personalizadaEl contenedor usa una red personalizada con IP estática para la base de datos:
   ```bash# Verificar la reddocker network lsdocker network inspect sg-api_app_network### Volúmenes para persistenciaLos datos de las huellas se almacenan en un volumen Docker:
   ```bash# Verificar volumendocker volume inspect sg-api_db_data---Para más información, contacta al equipo de desarrollo o consulta la documentación del SDK de SecuGen.